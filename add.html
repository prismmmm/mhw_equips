<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <script src="./js/jquery.js"></script>
  <title>装備登録</title>
</head>

<body>
  タイトル： <input type="text" id="title" class="title" /> <br />
  投稿者：
  <select id="user" class="user">
    <option value="">未選択</option>
  </select>
  <br />
  武器種：
  <select id="type" class="type">
    <option value="none">未選択</option>
  </select>

  <br />
  <br />
  武器：
  <select id="wep" class="wep">
    <option value="">武器種を選択してください</option>
  </select>
  装飾品：
  <select id="wep_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="wep_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="wep_dec3" class="dec">
    <option value="">-</option>
  </select>
  <br />
  頭：
  <select id="helm" class="arm">
    <option value="">未選択</option>
  </select>
  装飾品：
  <select id="helm_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="helm_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="helm_dec3" class="dec">
    <option value="">-</option>
  </select>

  <br />
  胴：
  <select id="body" class="arm">
    <option value="">未選択</option>
  </select>
  装飾品：
  <select id="body_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="body_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="body_dec3" class="dec">
    <option value="">-</option>
  </select>
  <br />
  腕：
  <select id="hand" class="arm">
    <option value="">未選択</option>
  </select>
  装飾品：
  <select id="hand_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="hand_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="hand_dec3" class="dec">
    <option value="">-</option>
  </select>
  <br />
  腰：
  <select id="waist" class="arm">
    <option value="">未選択</option>
  </select>
  装飾品：
  <select id="waist_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="waist_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="waist_dec3" class="dec">
    <option value="">-</option>
  </select>
  <br />
  脚：
  <select id="leg" class="arm">
    <option value="">未選択</option>
  </select>
  装飾品：
  <select id="leg_dec1" class="dec">
    <option value="">-</option>
  </select>
  <select id="leg_dec2" class="dec">
    <option value="">-</option>
  </select>
  <select id="leg_dec3" class="dec">
    <option value="">-</option>
  </select>
  <br>
  護石：
  <select id="charm" class="charm">
    <option value="">-</option>
  </select>

  <p>発動スキル</p>
  <select id="skil1" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil1_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  &nbsp
  <select id="skil2" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil2_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  <br />
  <select id="skil3" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil3_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  &nbsp
  <select id="skil4" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil4_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  <br />
  <select id="skil5" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil5_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  &nbsp
  <select id="skil6" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil6_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  <br />
  <select id="skil7" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil7_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  &nbsp
  <select id="skil8" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil8_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  <br />
  <select id="skil9" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil9_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  &nbsp
  <select id="skil10" class="skil">
    <option value="">-</option>
  </select>
  <select id="skil10_lv" class="level">
    <option value="Lv0">Lv0</option>
  </select>
  <p>コメント</p>
  <textarea name="" id="comment" class="comment" cols="30" rows="1"></textarea>

  <br>
  <button type="button" id="button">登録</button>

  <script>
    const users = ["prism", "devi", "taimeshi", "yosshi", "0096", "aruginin"]
    const skils = ["火強化", "水強化", "雷強化", "氷強化", "龍強化", "火耐性", "水耐性", "雷耐性", "氷耐性", "龍耐性", "ガード強化", "ガード性能", "回避力UP", "回避性能", "回復速度", "火事場力", "感知", "貫通弾・竜の一矢強化", "気絶耐性", "キノコ大好き", "強化持続", "KO術", "広域化", "攻撃", "剛刃研磨", "渾身", "散弾・剛射強化", "弱点特攻", "集中", "瘴気環境適応", "瘴気耐性", "心眼/弾道強化", "睡眠強化", "精霊の加護", "属性開放/装填拡張", "属性やられ耐性", "体術", "体力回復量UP", "体力増強", "匠", "特射強化", "抜刀術", "納刀術", "破壊王", "早食い", "フルチャージ", "砲撃手", "砲術", "ボマー", "砲弾装弾数UP", "満腹感", "見切り", "耳栓", "無属性強化", "弓溜め段階開放", "ランナー", "属性会心", "スタミナ上限突破", "達人芸", "業物","超会心"];
    const type = { great_sword: '大剣', long_sword: "太刀", sword_and_shild: '片手剣', dual_blates: '双剣', hammer: 'ハンマー', hunting_horn: '狩猟笛', lance: 'ランス', gun_lance: 'ガンランス', switch_axe: 'スラッシュアックス', chage_blade: 'チャージアックス', insent_glaive: '操虫棍', bow: '弓', light_bowgun: 'ライトボウガン', heavy_bowgun: 'ヘヴィボウガン' };
    const none = ["武器種を選択してください"];

    const bow = ["未選択", "ガイラアロー雷", "ガイラアロー水", "ジャナフアルカウス", "レイ=ファーンライク", "竜骨弓Ⅲ", "飛雷弓【羽々矢】", "ブレイブハンターボウⅡ"];
    const great_sword = ["未選択", "滅鬼の凶器", "竜熱機関式【鋼翼】改"]
    const long_sword = ["未選択", "滅尽の一刀", "天上天下無双刀", "カラミティペイン", "ガイラソード火"];
    const sword_and_shild = ["未選択", "使わんやろwwwww"];
    const dual_blates = ["未選択", "残滅の爪", "氷炎剣ヴィルマフレア", "残滅の爪"];
    const hammer = ["未選択", "ブロスシャッター"];
    const hunting_horn = ["未選択", "使わんやろwwww"];
    const lance = ["未選択", "亡滅の腕", "ラ・モールの哀愁", "ガロンダーラⅡ", "アトロシスタワー", "エンプレスランス・冥灯"]
    const gun_lance = ["未選択", "追加予定"]
    const switch_axe = ["未選択", "ガイラアックス麻痺"]
    const chage_blade = ["未選択", "タイラントブロスⅡ"]
    const insent_glaive = ["未選択", "追加予定"]
    const light_bowgun = ["未選択", "エンプレスシェル・冥灯", "エンプレスシェル・炎妃", "マッドネスグリーフ", "業【カルマ】", "グルゴレットの叫喚"];
    const heavy_bowgun = ["未選択", "ガイラアサルト 賊", "マグダ・ゲミトゥスⅡ", "アンフィニグラ"];
    const charms = ["攻撃の護石","体術の護石","KOの護石","覚醒の護石","渾身の護石","茸好の護石","鉄壁の護石","達人の護石","匠の護石","超心の護石","痛撃の護石","抜刀の護石","爆師の護石","無傷の護石","耳栓の護石","友愛の護石"];
    const wepons = { none, great_sword, long_sword, sword_and_shild, dual_blates, hammer, hunting_horn, lance, gun_lance, switch_axe, chage_blade, insent_glaive, bow, light_bowgun, heavy_bowgun };
    const armors = ["ウルズα", "ウルズβ", "ウルズγ", "カイザーα", "カイザーβ", "カイザーγ", "キリンα", "キリンβ", "キリンγ", "クシャナα", "クシャナβ", "クシャナγ", "ゼノラージα", "ゼノラージβ", "ゼノラージγ", "ゾラマグγ", "ドラケンα", "マムガイラα", "マムガイラβ", "エンプレスα", "エンプレスβ", "エンプレスγ", "シーカーα", "シーカーβ", "竜王の隻眼α", "オーグα", "オーグβ", "ダンテα", "ギルドクロスα", "ギルドクロスβ", "スカルα", "スカルβ", "デスギアα", "デスギアβ", "ダマスクα", "ダマスクβ", "ドーベルα", "ドーベルβ", "ガンキンα", "ガンキンβ", "龍封じのピアスα", "バゼルα", "バゼルβ", "バンギスα", "バンギスβ", "流星ノ将【兜】α", "ディアネロα", "ディアネロβ", "リオソウルα", "リオソウルβ", "レウスα", "レウスβ", "オリオンα", "アイルーフェイクα", "ラヴァα", "ラヴァβ", "ガロンα", "ガロンβ", "ギエナα", "ギエナβ", "ディアブロα", "ディアブロβ", "ハーベストα", "ブリゲイドα", "ブリゲイドβ", "リオハートα", "リオハートβ", "インゴットα", "インゴットβ", "ハイメタα", "ハイメタβ", "ガストα", "ガストβ", "バルキンα", "バルキンβ"];
    //const skils = ["属性強化", "攻撃", "防御", "体力"];

    const levels = ["Lv1", "Lv2", "Lv3", "Lv4", "Lv5", "Lv6", "Lv7"];

    let data = {
      user: "user name",
      title: "no title",
      type: "",
      comment: "",
      charm: ""
    };

    window.onload = function () {
      //deta配列初期化
      for (let i = 1; i < 11; i++) {
        data[`skil${i}`] = "-";
        data[`skil${i}_lv`] = 0;
      }

      var ids = ["wep", "helm", "body", "hand", "waist", "leg"];
      ids.forEach(id => {
        data[`${id}`] = "";
        for (let i = 1; i < 4; i++) {
          data[`${id}_dec${i}`] = "-";
        }
      });

      $("#type").change(function () {
        const wep = wepons[$(this).val()];

        //select 初期化
        const x = document.getElementById("wep");
        if (x.hasChildNodes()) {
          while (x.childNodes.length > 0) {
            x.removeChild(x.firstChild);
          }
        }

        wep.forEach(val => {
          let op = document.createElement("option");
          op.value = val;
          op.text = val;
          document.getElementById("wep").appendChild(op);
        });
      });

      //スキル変更イベント
      $(".skil").change(function () {
        var id = $(this).attr("id");
        data[id] = $(this).val();

        console.log(data);
      });

      $(".level").change(function () {
        var id = $(this).attr("id");
        data[id] = $(this).val();

        console.log(data);
      });

      $('#button').click(function () {
        var json = JSON.stringify(data, null, "\t")
        const res = window.confirm('この内容で登録しますか？');
        if (res) {
          send_data = json;

          $.ajax({
            url: "php/set_equip.php", // 送信先のPHP
            type: "POST", // POSTで送る
            contentType: "Content-Type: application/json; charset=UTF-8",
            dataType: 'json',
            data: send_data //JSON形式の送信データ
          });
          console.log(json);
        }

      });

      $(document).on("change", ".wep, .dec, .arm, .user, .title, .type, .comment,.charm", function () {
        var id = $(this).attr("id");
        data[id] = $(this).val();
        console.log(data);
      });

      //装飾品追加
      let arr = document.getElementsByClassName("dec");
      for (let i = 0; i < arr.length; i++) {
        skils.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("dec")[i].appendChild(op);
        });
      }

      Object.keys(type).forEach(function (key) {
        const val = this[key];
        let op = document.createElement("option");
        op.value = key;
        op.text = val;
        document.getElementById("type").appendChild(op);
      }, type);

      arr = document.getElementsByClassName("arm");
      for (let i = 0; i < arr.length; i++) {
        armors.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("arm")[i].appendChild(op);
        });
      }

      //skil
      arr = document.getElementsByClassName("skil");
      for (let i = 0; i < arr.length; i++) {
        skils.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("skil")[i].appendChild(op);
        });
      }
      //level
      arr = document.getElementsByClassName("level");
      for (let i = 0; i < arr.length; i++) {
        levels.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("level")[i].appendChild(op);
        });
      }

      //charm
      arr = document.getElementsByClassName("charm");
      for (let i = 0; i < arr.length; i++) {
        charms.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("charm")[i].appendChild(op);
        });
      }

      //charm
      arr = document.getElementsByClassName("user");
      for (let i = 0; i < arr.length; i++) {
       users.forEach(d => {
          let op = document.createElement("option");
          op.value = d;
          op.text = d;
          document.getElementsByClassName("user")[i].appendChild(op);
        });
      }
    };
  </script>
</body>

</html>